$schema: https://json-schema.org/draft/2020-12/schema
$id: https://schemas.microsoft.com/dsc/2023/07/bundled/config.document.yaml
title: DSC Configuration Document schema
description: Describes a valid DSC Configuration Document.
type: object
required:
- $schema
- resources
properties:
  $schema:
    title: Schema
    description: This property must be the canonical URL of the DSC Configuration Document schema that the document is implemented for.
    type: string
    format: uri
    enum:
    - https://schemas.microsoft.com/dsc/2023/07/config/document.yaml
  parameters:
    $ref: /dsc/2023/07/config/document.parameters.yaml
  variables:
    title: Configuration variables
    description: Defines a set of reusable values for the configuration document. The names of this value's properties are the strings used to reference a variable's value.
    type: object
  resources:
    $ref: /dsc/2023/07/config/document.resources.yaml
  metadata:
    title: Configuration metadata
    description: Defines a set of key-value pairs for the configuration. This metadata isn't validated.
    type: object
$defs:
  https://schemas.microsoft.com/dsc/2023/07/config/document.parameters.yaml:
    $schema: https://json-schema.org/draft/2020-12/schema
    $id: https://schemas.microsoft.com/dsc/2023/07/config/document.parameters.yaml
    title: DSC Configuration document parameters
    description: Defines runtime options for the configuration. Users and integrating tools can override use the defined parameters to pass alternate values to the configuration.
    type: object
    patternProperties:
      .:
        title: Parameter
        description: Defines a runtime option for a DSC Configuration Document.
        type: object
        required:
        - type
        properties:
          type:
            $ref: /dsc/2023/07/definitions/parameters/dataType.yaml
          defaultValue:
            title: Default value
            description: Defines the default value for the parameter.
            $ref: /dsc/2023/07/definitions/parameters/validValueTypes.yaml
          allowedValues:
            title: Allowed values
            description: Defines a list of valid values for the parameter. If the parameter is defined with any other values, it's invalid.
            type: array
            items:
              $ref: /dsc/2023/07/definitions/parameters/validValueTypes.yaml
          description:
            title: Parameter description
            description: Defines a synopsis for the parameter explaining its purpose.
            type: string
          metadata:
            title: Parameter metadata
            description: Defines a set of key-value pairs for the parameter. This metadata isn't validated.
            type: object
        allOf:
        - if:
            properties:
              type:
                const: int
          then:
            $ref: /dsc/2023/07/definitions/parameters/integerValidationProperties.yaml
        - if:
            oneOf:
            - properties:
                type:
                  const: string
            - properties:
                type:
                  const: securestring
            - properties:
                type:
                  const: array
          then:
            $ref: /dsc/2023/07/definitions/parameters/lengthValidationProperties.yaml
  https://schemas.microsoft.com/dsc/2023/07/config/document.resources.yaml:
    $schema: https://json-schema.org/draft/2020-12/schema
    $id: https://schemas.microsoft.com/dsc/2023/07/config/document.resources.yaml
    title: DSC Configuration document resources
    description: Defines a list of DSC Resource instances for the configuration to manage.
    type: array
    items:
      title: DSC Resource instance
      type: object
      required:
      - type
      - name
      properties:
        type:
          $ref: /dsc/2023/07/definitions/resourceType.yaml
        name:
          $ref: /dsc/2023/07/definitions/instanceName.yaml
        dependsOn:
          title: Instance depends on
          description: Defines a list of DSC Resource instances that DSC must successfully process before processing this instance. Each value for this property must be the value of another DSC Resource instance's `name` property.
          type: array
          items:
            type: string
            uniqueItems: true
        properties:
          title: Managed instance properties
          description: Defines the properties of the DSC Resource this instance manages. This property's value must be an object. DSC validates the property's value against the DSC Resource's schema.
          type: object
  https://schemas.microsoft.com/dsc/2023/07/definitions/parameters/dataType.yaml:
    $schema: https://json-schema.org/draft/2020-12/schema
    $id: https://schemas.microsoft.com/dsc/2023/07/definitions/parameters/dataType.yaml
    title: Data Type
    description: Defines the data type for the value.
    type: string
    enum:
    - string
    - securestring
    - int
    - bool
    - object
    - secureobject
    - array
  https://schemas.microsoft.com/dsc/2023/07/definitions/parameters/validValueTypes.yaml:
    $schema: https://json-schema.org/draft/2020-12/schema
    $id: https://schemas.microsoft.com/dsc/2023/07/definitions/parameters/validValueTypes.yaml
    $comment: >
      This schema fragment makes it a little easier to compose the valid properties

      for DSC Configuration document parameters. As-written, values must be one of

      those on this list - the schema definition for dataType excludes `null` and

      numbers with fractional parts, like `3.5`.
    type:
    - string
    - integer
    - object
    - array
    - boolean
  https://schemas.microsoft.com/dsc/2023/07/definitions/parameters/integerValidationProperties.yaml:
    $schema: https://json-schema.org/draft/2020-12/schema
    $id: https://schemas.microsoft.com/dsc/2023/07/definitions/parameters/integerValidationProperties.yaml
    $comment: >
      This schema fragment makes it a little easier to compose the valid properties

      for DSC Configuration document parameters. These only apply to `int` type

      parameters.
    properties:
      minValue:
        title: Minimum value
        description: The minimum valid value for an integer type. If defined with the `maxValue` property, this value must be less than the value of `maxValue`.
        type: integer
        minimum: 0
      maxValue:
        title: Maximum value
        description: The maximum valid value for an integer type. If defined with the `minValue` property, this value must be greater than the value of `minValue`.
        type: integer
        minimum: 0
  https://schemas.microsoft.com/dsc/2023/07/definitions/parameters/lengthValidationProperties.yaml:
    $schema: https://json-schema.org/draft/2020-12/schema
    $id: https://schemas.microsoft.com/dsc/2023/07/definitions/parameters/lengthValidationProperties.yaml
    $comment: >
      This schema fragment makes it a little easier to compose the valid properties

      for DSC Configuration document parameters. These only apply to `string`,

      `securestring`, and `array` type parameters.
    properties:
      minLength:
        title: Minimum length
        description: The minimum valid length for a `string`, `securestring`, or `array`. If defined with the `maxLength` property, this value must be less than the value of `maxLength`.
        type: integer
        minimum: 0
      maxLength:
        title: Maximum length
        description: The maximum valid length for a `string`, `securestring`, or `array`. If defined with the `minLength` property, this value must be less than the value of `minLength`.
        type: integer
        minimum: 0
  https://schemas.microsoft.com/dsc/2023/07/definitions/resourceType.yaml:
    $schema: https://json-schema.org/draft/2020-12/schema
    $id: https://schemas.microsoft.com/dsc/2023/07/definitions/resourceType.yaml
    title: DSC Resource fully qualified type name
    description: >
      The namespaced name of the DSC Resource, using the syntax:


      owner[.group][.area]/name


      For example:

        - Microsoft.SqlServer/Database
        - Microsoft.SqlServer.Database/User
    type: string
    pattern: ^\w+(\.\w+){0,2}\/\w+$
  https://schemas.microsoft.com/dsc/2023/07/definitions/instanceName.yaml:
    $schema: https://json-schema.org/draft/2020-12/schema
    $id: https://schemas.microsoft.com/dsc/2023/07/definitions/instanceName.yaml
    title: Instance name
    description: The short, human-readable name for a DSC Resource instance. Must be unique within a DSC Configuration document.
    type: string
