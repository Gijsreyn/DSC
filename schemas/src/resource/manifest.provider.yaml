# yaml-language-server: $schema=https://json-schema.org/draft/2020-12/schema
$schema: https://json-schema.org/draft/2020-12/schema
$id:     <HOST>/<PREFIX>/<VERSION>/resource/manifest.provider.yaml

title: Provider
description: >-
  Defines the DSC Resource as a DSC Resource Provider. A DSC Resource Provider enables users to
  manage resources that don't have their own manifests with DSC.
markdownDescription: | # VS Code only
  > [Online Documentation][01]

  Defines the DSC Resource as a DSC Resource Provider. A DSC Resource Provider enables users to
  manage resources that don't have their own manifests with DSC.

  [01]: https://learn.microsoft.com/powershell/dsc/reference/schemas/resource/manifest/provider?view=dsc-3.0&preserveView=true

type: object
required:
  - list
  - config
properties:
  list:
    title: List Command
    description: >-
      Defines how DSC must call the DSC Resource Provider to list its supported DSC Resources.
    markdownDescription: | # VS Code only
      > [Online Documentation][01]

      Defines how DSC must call the DSC Resource Provider to list its supported DSC Resources.

      [01]: https://learn.microsoft.com/powershell/dsc/reference/schemas/resource/manifest/provider?view=dsc-3.0&preserveView=true#list
    type: object
    required:
      - executable
    properties:
      executable:
        $ref: /<PREFIX>/<VERSION>/definitions/commandExecutable.yaml
      args:
        $ref: /<PREFIX>/<VERSION>/definitions/commandArgs.yaml
  config:
    title: Expected Configuration
    description: >-
      Defines whether the provider expects to receive a full and unprocessed configuration as a
      single JSON blob over stdin or a sequence of JSON Lines for each child resource's
      configurations.
    type: string
    enum:
      - full
      - sequence
    # VS Code only
    markdownDescription: |
      > [Online Documentation][01]

      Defines whether the provider expects to receive a full and unprocessed configuration as a
      single JSON blob over stdin or a sequence of JSON Lines for each child resource's
      configurations.

      [01]: https://learn.microsoft.com/powershell/dsc/reference/schemas/resource/manifest/provider?view=dsc-3.0&preserveView=true#config
    markdownEnumDescriptions:
      # full
      - |
          Indicates that the provider expects a JSON blob containing the full and unprocessed
          configuration as a single JSON blob over `stdin`.
      # sequence
      - |
          Indicates that the provider expects each resource's configuration as a [JSON Line][01]
          over `stdin`.

          [01]: https://jsonlines.org/

examples:
  - config: full
    list:
      executable: pwsh
      args:
        - -NoLogo
        - -NonInteractive
        - -NoProfile
        - -Command
        - ./powershellgroup.resource.ps1 List
